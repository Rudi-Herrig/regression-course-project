---
title: "Project Paper 1 - Revised"
author: "Rudi Herrig and Jordan Kim"
date: "4 May 2024"
output:
  pdf_document: default
---

```{r setup, include=FALSE}
library(knitr)
library(tinytex)
library(readxl)
library(tidyverse)
library(stringr)
library(magrittr)
library(ggplot2)
# install.packages("corrr")
library(corrr)
# install.packages("corrplot")
library(corrplot)

knitr::opts_chunk$set(echo = FALSE)
knitr::opts_chunk$set(message = FALSE)
knitr::opts_chunk$set(warning = FALSE)
knitr::opts_chunk$set(out.width = "60%",fig.align='center')
```

I wanted to try creating a binary response variable indicating whether a county joined the South because the state in which it is located fought against the Union. I will use the following states: Alabama, Arkansas, Florida, Georgia, Louisiana, Mississippi, North Carolina, South Carolina, Tennessee, Texas, and Virginia. I will create a new variable, Confederate, which is equal to 1 if the county is in one of these states, and 0 if the county is not in one of these states. I will use the mutate function to create this new variable.

```{r}
# 1280 rows
# ADB - production of industries
# ADE - Men employed in selected industries
production <- read_xlsx("USCensus_1840_county.xlsx")
# to check for data structure, `summary(production)` is used

# 1280 rows
# ACX - County Borders Navigable waterway, 1 if yes
navig <- read_xlsx("USCensusData1840.xlsx")
# There was an extra row in `navig` for D.C.'s county of Alexandria (distinct from Rural County of Alexandria) so I removed it.
navig <- navig[-101,]

# 1280 rows
# ADC - Capital Invested
# ADD - Persons Employed
capital <- read_xlsx("USCensusData1840_2.xlsx")

# 1280 rows
# ACK001 - 
literacy <- read_xlsx("USCensus1840Literacy.xlsx")
# Just like `navig`, there was an extra row in `literacy` for D.C.'s county of Alexandria (distinct from Rural County of Alexandria) so I removed it.
literacy <- literacy[-101,]
```

```{r}
# bigboy is all the data sets combined
bigboy <- production %>% inner_join(navig) %>% inner_join(capital) %>% inner_join(literacy)

# bignav is to try to salvage the navigable waterway variable as the response
bignav <- navig %>%  inner_join(capital) %>% inner_join(production)

# 1280 rows
# Population data
population <- read_xlsx("USCensus_1840_counties.xlsx")

population <- population[-101,] # removing Alexandria row

# Adding the industry, manufacturing, and navigable waterway data to the population data
# 1280 rows
# ADB - production of industries
# ADE - Men employed in selected industries
production <- read_xlsx("USCensus_1840_county.xlsx")
# to check for data structure, `summary(production)` is used

# 1280 rows
# ACX - County Borders Navigable waterway, 1 if yes
navig <- read_xlsx("USCensusData1840.xlsx")
# There was an extra row in `navig` for D.C.'s county of Alexandria (distinct from Rural County of Alexandria) so I removed it.
navig <- navig[-101,]

# 1280 rows
# ADC - Capital Invested
# ADD - Persons Employed
capital <- read_xlsx("USCensusData1840_2.xlsx")

# 1280 rows
# ACK001 - 
literacy <- read_xlsx("USCensus1840Literacy.xlsx")
# Just like `navig`, there was an extra row in `literacy` for D.C.'s county of Alexandria (distinct from Rural County of Alexandria) so I removed it.
literacy <- literacy[-101,]
```

```{r}
# bigboy is all the data sets combined
bigboy <- production %>% inner_join(navig) %>% inner_join(capital) %>% inner_join(literacy)

# bignav is to try to salvage the navigable waterway variable as the response
bignav <- navig %>%  inner_join(capital) %>% inner_join(production)

# bigpop is all our data aggregated
bigpop <- population %>% inner_join(bignav)
```

```{r}
# separating header row to further clean up the data set
bigpophead <- bigpop %>% slice_head()

# removing header row
bigpopdata <- bigpop[-1,]

# Converting our data from chr to dbl with as.numeric()
bigpopdata[,10:ncol(bigpopdata)] <- as.data.frame(apply(bigpopdata[,10:ncol(bigpopdata)], 2, function(x) (as.numeric(x))))

# population_head <- population %>% slice_head() # separating header row to further clean up the data set
# popdata <- population[-1,] # removing header row


# Creating new variables
bigpopdata <- bigpopdata %>%
  mutate(STATE=as.factor(STATE),
         COUNTY=as.factor(COUNTY),
         ACZYZ=ACZ/(ACY+ACZ), # ACZYZ is the Percentage of Colored population
         ACKY=ACK001/ACY, # ACKY is the Percentage of White Illiteracy
         ACH=ACH001+ACH002+ACH003, # ACH is the total number of Learning Institutions
         ACI=ACI001+ACI002+ACI003, # ACI is the total number of Students
         ACL=ACL001+ACL002, # ACL is Number of Printing and Binding Services
         ACM=ACM001+ACM002+ACM003+ACM004, # ACM is Number of Newspapers and Periodicals
         AC1=AC1003+AC1004+AC1005+AC1006+AC1007, # AC1 is the total number of Employed persons in Learned Professions Requiring Literacy
         ACE=AC3003+ACE001, # ACE is the number of White Deaf, Dumb, and Blind Persons Over 20
         ACS=ACS001+ACS002+ACS003, # ACS is Total Persons
         ACSW= ACS001, # ACSW is Total White Persons
         ACSNW= ACS002+ACS003, # ACSNW is Total Non-White Persons
         ACSP=ACSNW/ACS, # ACSP is the percentage of non-white population
         ACSWP=ACSW/ACS, # ACSWP is the percentage of white population
         Confederate=as.integer(STATE %in% c("Alabama", "Arkansas", "Florida", "Georgia", "Louisiana", "Mississippi", "North Carolina", "South Carolina", "Tennessee", "Texas", "Virginia")))

bigpopdatahead <- bigpophead %>%
  mutate(ACD001="Total Population",
         ACN001="Total Urban Population",
         ACZYZ="Percentage of Colored Population",
         ACKY="Percentage of White Illiteracy",
         ACH="Total Learning Institutions",
         ACI="Total Number of Students",
         ACL="Number of Printing and Binding Services",
         ACM="Number of Newspapers and Periodicals",
         AC1="Total Employed in Learned Professions",
         ACE="White Deaf, Dumb, and Blind Persons Over 20",
         ACS="Total Persons",
         ACSW="Total White Persons",
         ACSNW="Total Non-White Persons",
         ACSP="Percentage of Non-White Population",
         ACSWP="Percentage of White Population",
         Confederate="Joined Confederacy and Raised Arms Against The United States = 1")

# bigpopdata <- bigpopdata %>%
#  na.omit() # removing rows with NA values

# Re-adding the header row with new descriptions - but this converted the whole list into 'chr' NO!!!!
# Create a list to keep them together but separate for statistical analyses
bigpopdata_list <- list(Headers = bigpopdatahead, Data = bigpopdata)

# glimpse(popdata_list)
```

Filtering for only the columns we're interested in and creating a new list `WhiteIlliterate`
```{r}
# WhiteIlliteracy <- popdata_list$Data  %>%
#   select(GISJOIN, STATE, STATEA, STATEICP, COUNTY, COUNTYA, COUNTYICP, ACD001, ACN001,  ACK001, ACY, ACKY, ACZYZ, ACH, ACI, ACL, ACM, AC1, ACE, ACS, ACSW, ACSNW, ACSP, ACSWP, Confederate)
# glimpse(WhiteIlliteracy)
# WhiteIlliteracyHead <- popdata_list$Headers %>%
#   select(GISJOIN, STATE, STATEA, STATEICP, COUNTY, COUNTYA, COUNTYICP, ACD001, ACN001,  ACK001, ACY, ACKY, ACZYZ, ACH, ACI, ACL, ACM, AC1, ACE, ACS, ACSW, ACSNW, ACSP, ACSWP, Confederate)
# glimpse(WhiteIlliteracyHead)
# WhiteIlliterate <- list(Headers = WhiteIlliteracyHead, Data = WhiteIlliteracy)
# glimpse(WhiteIlliterate)
WhiteIlliteracy <- bigpopdata %>%
  select(-c(1:2,4,6:9)) # removing unnecessary columns
WhiteIlliteracyHead <- bigpopdatahead %>%
  select(-c(1:2,4,6:9)) # removing unnecessary columns
WhiteIlliterate <- list(Headers = WhiteIlliteracyHead, Data = WhiteIlliteracy)
str(WhiteIlliteracy)
```

```{r, include=FALSE}
if (!dir.exists("figures")) {
  dir.create("figures")
}
```
### Visualizing data we're interested in to learn more about relationships among data set with Blue representing Union counties and Red representing Confederate counties
#### The visualization of the response variable, White Illiteracy, with Percentage of Non-White Population as potential predictor
```{r, fig.path="figures/"}
ACSP <- ggplot(WhiteIlliterate$Data, aes(x=ACSP, y=ACKY, color=factor(Confederate))) +
  geom_point(alpha=0.2) +
  geom_jitter(height=0.05, size=2, alpha=0.6) +
  scale_color_manual(values=c("0"="blue", "1"="red"),
                     labels=c("Union", "Confederate"),
                     name="Civil War Alignment") +
  theme_bw() +
  labs(x="Percentage of Non-White Population", y="White Illiteracy Rate (%)",
       title="Impact of Racial Composition on White Illiteracy",
       subtitle="Comparison by Civil War Alignment")
ACSP
ggsave("ACSP.png", plot=ACSP)
```

#### Visualizing the response variable, White Illiteracy, with Number of Newspapers and Periodicals produced as potential predictor
```{r, fig.path="figures/"}
ACM <- ggplot(WhiteIlliterate$Data, aes(x=ACM, y=ACKY, color=factor(Confederate))) +
  geom_point(alpha=0.2) +
  geom_jitter(height=0.05, size=2, alpha=0.6) +
  scale_color_manual(values=c("0"="blue", "1"="red"),
                     labels=c("Union", "Confederate"),
                     name="Civil War Alignment") +
  theme_bw() +
  labs(x="Number of Newspapers and Periodicals", y="White Illiteracy Rate (%)",
       title="Implicating Impact of Newspapers Media Produced on White Illiteracy Rate",
       subtitle="Comparison by Civil War Alignment")
ACM
ggsave("ACM.png", plot=ACM)
```

#### Visualizing the response variable, White Illiteracy, with Number of Students as potential predictor
```{r, fig.path="figures/"}
ACI <- ggplot(WhiteIlliterate$Data, aes(x=ACI, y=ACKY, color=factor(Confederate))) +
  geom_point(alpha=0.2) +
  geom_jitter(height=0.05, size=2, alpha=0.6) +
  scale_color_manual(values=c("0"="blue", "1"="red"),
                     labels=c("Union", "Confederate"),
                     name="Civil War Alignment") +
  theme_bw() +
  labs(x="Number of Students", y="White Illiteracy Rate (%)",
       title="Impact of Educational Enrollment on Literacy",
       subtitle="Comparison by Civil War Alignment")
ACI
ggsave("ACI.png", plot=ACI)
```

#### Visualizing the relationship between the Number of Learning Institutions and White Illiteracy
```{r, fig.path="figures/"}
ACH <- ggplot(WhiteIlliterate$Data, aes(x=ACH, y=ACKY, color=factor(Confederate))) +
  geom_point(alpha=0.2) +  
  geom_jitter(height=0.05, size=2, alpha=0.6) +  
  scale_color_manual(values=c("0"="blue", "1"="red"),  # Colors for Union and Confederate
                     labels=c("Union", "Confederate"),
                     name="Civil War Alignment") +
  theme_bw() +
  labs(x="Number of Learning Institutions",
       y="White Illiteracy Rate (%)",
       title="Influence of Educational Institutions on Literacy",
       subtitle="Comparison by Civil War Alignment")
ACH
ggsave("ACH.png", plot=ACH)
```

#### Visualizing the response variable, White Illiteracy, with Number of Persons in Learned Professions Requiring Literacy as potential predictor
```{r, fig.path="figures/"}
AC1 <- ggplot(popdata, aes(x=AC1, y=ACKY, color=factor(Confederate))) +
  geom_jitter(width=0.2, height=0.2, alpha=0.6) + 
  scale_color_manual(values=c("0"="blue", "1"="red"),  # Colors for Union and Confederate
                     labels=c("0"="Union", "1"="Confederate"),
                     name="Civil War Alignment") + 
  theme_bw() + 
  labs(x="Number of Persons in Learned Professions",
       y="White Illiteracy Rate (%)",
       title="Civil War Alignment by County",
       subtitle="Based on Confederate or Union alignment during the Civil War")
AC1
ggsave("AC1.png", plot=AC1)
```

### Visualizing new binary variable, `Confederate`, as potential response, with White Illiteracy as potential predictor
```{r, fig.path="figures/"}
Confederate <- ggplot(WhiteIlliterate$Data, aes(x=ACKY, y=Confederate)) +
  geom_point() +
  geom_jitter(height=0.05,size=2,alpha=0.2) +
  theme_bw()
Confederate
ggsave("Confederate.png", plot=Confederate)
```

```{r}
# I wanted to write the cleaned up data frame into a file.
# install.packages("openxlsx")
library(openxlsx)

# Create a new workbook
wb <- createWorkbook()
# Add sheets to the workbook
addWorksheet(wb, "Data")
addWorksheet(wb, "Headers")
# Write data to the respective sheets
writeData(wb, sheet = "Data", WhiteIlliteracy)
writeData(wb, sheet = "Headers", WhiteIlliteracyHead)
# Save the workbook
saveWorkbook(wb, "WhiteIlliterate.xlsx", overwrite = TRUE)

# Repeat the process for the other list
wb_popdata <- createWorkbook()
addWorksheet(wb_popdata, "Data")
addWorksheet(wb_popdata, "Headers")
writeData(wb_popdata, sheet = "Data", popdata_list$Data)
writeData(wb_popdata, sheet = "Headers", popdata_list$Headers)
saveWorkbook(wb_popdata, "popdata.xlsx", overwrite = TRUE)
```

# Splitting Data into Training and Testing Sets
```{r}
# ready to split into training and testing data 3:1
set.seed(303)
trows <- sample(x=nrow(WhiteIlliterate$Data),size=floor(0.75*nrow(WhiteIlliterate$Data)),replace=FALSE)
#separate data
train <- WhiteIlliterate$Data[trows,]
test <- WhiteIlliterate$Data[-trows,]
```

# The Response Variable and potential Predictors
In this revision, we also created a new response variable ACKY, which is the percentage of white illiteracy in a county. It is calculated by dividing the Total Number of Whites Over 20 Who Cannot Read or Write by the Total White Population.
We will use this as our response variable in our logistic regression model. We also created a binary variable, Confederate, which is equal to 1 if the county was in the South and joined the Confederacy and fought against the United States, and 0 if the county defended our nation and freedom against the evils of Slavery and White Supremacists. We will potentially use the following predictor variables: STATE - "The State (as factors)", ACD001 - "Total Population", ACN001 - "Total Urban Population", ACK001 - "Total White Persons Over 20 Who Cannot Read or Write", ACY - "Total White Persons Over 20", ACZYZ - "Percentage of Colored Population", ACH - "Total Learning Institutions", ACI - "Total Number of Students", ACL - "Number of Printing and Binding Services", ACM - "Number of Newspapers and Periodicals", AC1 - "Total Employed in Learned Professions", ACE - "White Deaf, Dumb, and Blind Persons Over 20", ACS - "Total Persons", ACSW - "Total White Persons", ACSNW - "Total Non-White Persons", ACSP - "Percentage of Non-White Population", ACSWP - "Percentage of White Population". We will use the glm function, Gaussian family, and ACKY~STATE+ACD001+ACN001+ACK001+ACY+ACZYZ+ACH+ACI+ACL+ACM+AC1+ACE+ACS+ACSW+ACSNW+ACSP+ACSWP+Confederate formula to build a multiple linear regression model. As seen above, we have split our data into training and testing sets, for testing our model's performance.

# Null Model
```{r}
mean(train$ACKY)
```
We'll have a null model using the training set data, which is the mean of the response variable, ACKY, to compare our model's predictions on the testing set data performance to. The training set data mean White Illiteracy Rate for counties is $0.1479186$, or $14.79\%$ We will use the RMSE to evaluate our model's performance. We will also look at the distributions of the predictor variables and the correlation between the predictor variables and the response variable.

We will also utilize various techniques to try to find the best model, from shrinkage, dimension reduction, model selection and variable selection. We will also look at the distributions of the predictor variables and the correlation between the predictor variables and the response variable.

# Forward Stepwise Variable Selection
```{r message=TRUE, warning=TRUE}
#load libraries
library(olsrr)

#define the model
model <- glm(ACK001~.,data=WhiteIlliteracy, family = "gaussian")

#execute forward stepwise
forward_model <- ols_step_forward_adj_r2(model)

#review selection steps
forward_model$metrics
```


# The Predictor Variables
We have chosen to use the following predictor variables to predict white illiteracy in counties: STATE - "The State (as factors)", ACD001 - "Total Population", ACN001 - "Total Urban Population", ACK001 - "Total White Persons Over 20 Who Cannot Read or Write", ACY - "Total White Persons Over 20", ACZYZ - "Percentage of Colored Population", ACH - "Total Learning Institutions", ACI - "Total Number of Students", ACL - "Number of Printing and Binding Services", ACM - "Number of Newspapers and Periodicals", AC1 - "Total Employed in Learned Professions", ACE - "White Deaf, Dumb, and Blind Persons Over 20", ACS - "Total Persons", ACSW - "Total White Persons", ACSNW - "Total Non-White Persons", ACSP - "Percentage of Non-White Population", ACSWP - "Percentage of White Population", and Confederate - "Joined Confederacy and Raised Arms Against The United States = 1". We will use the glm function, Gaussian family, and ACKY~STATE+ACD001+ACN001+ACK001+ACY+ACZYZ+ACH+ACI+ACL+ACM+AC1+
ACE+ACS+ACSW+ACSNW+ACSP+ACSWP+Confederate formula to build a multiple linear regression model. As seen above, we have split our data into training and testing sets, for testing our model's performance. We will also look at the distributions of the predictor variables and the correlation between the predictor variables and the response variable using the `corrr` package.


# building multiple logistic regression model using training dataset
```{r}
model <- glm(ACKY~STATE+ACD001+ACN001+ACK001+ACY+ACZYZ+ACH+ACI+ACL+ACM+AC1+ACE+ACS+ACSW+ACSNW+ACSP+ACSWP+Confederate+ACD001:Confederate+ACN001:Confederate+ACK001:Confederate+ACY:Confederate+ACZYZ:Confederate+ACH:Confederate+ACI:Confederate+ACL:Confederate+ACM:Confederate+AC1:Confederate+ACE:Confederate+ACS:Confederate+ACSW:Confederate+ACSNW:Confederate+ACSP:Confederate+ACSWP:Confederate, data = train, family = "binomial")
summary(model)
saveRDS(model, "model.rds")
```

The only significant predictor variable is the interaction between the percentage of white population and the Confederate variable. This is not a good sign for our model, as we want to see more significant predictor variables. This may be because of the distribution of our response, or the simple variability between counties.

# Association between Predictor Variables and Response Variable
```{r}
modelvariables <- train %>%
  select(ACKY, ACD001, ACN001, ACK001, ACY, ACZYZ, ACH, ACI, ACL, ACM, AC1, ACE, ACS, ACSW, ACSNW, ACSP, ACSWP, Confederate)
cor_matrix <- cor(modelvariables)
cor_matrix
pairs(modelvariables)
```

```{r}
png("corplot72.png", width = 1200, height = 1200)
pairs(modelvariables)
dev.off()
```

```{r}
png("corplot.png", width = 1200, height = 1200, res = 108)
pairs(modelvariables)
dev.off()
```

```{r}
png("correlation_matrix.png", width = 1200, height = 1200, res=144)
par(mar = c(1, 5, 4, 2) + 0.1)  # Adjust margins to give space for top axis labels
plot(1, type = "n", xlab = "", ylab = "", xlim = c(1, ncol(cor_matrix)), ylim = c(1, nrow(cor_matrix)), xaxt = 'n', yaxt = 'n')
# Adding variable names as axis labels
axis(3, at = 1:ncol(cor_matrix), labels = colnames(cor_matrix), las = 2, cex.axis = 0.7)  # Top axis
axis(2, at = rev(1:nrow(cor_matrix)), labels = rownames(cor_matrix), las = 2, cex.axis = 0.7)
# Add correlation coefficients as text, flipping the matrix vertically
for (i in 1:ncol(cor_matrix)) {
    for (j in 1:nrow(cor_matrix)) {
        text(i, nrow(cor_matrix) + 1 - j, round(cor_matrix[j, i], 2), cex = 0.8)
    }
}
dev.off()
```

```{r}
png("cormat2.png", width = 1200, height = 1200, res = 108)
# Generate the correlation plot without colors
corrplot(cor(modelvariables), method = "number", type = "upper",
         tl.col = "black", tl.srt = 45,
         number.cex = 0.8, # Adjust text size
         cl.pos = 'n') # Hide color legend
dev.off()
```

The correlation between the response variable and the predictor variables is varied, with the highest correlation being $0.51138311$ with `ACK001`, and the second highest being $0.34459402$ with `Confederate`. Weaker correlations and negative weaker correlations with many variables.
`ACH` and `ACI` had negative correlation coefficients of $-0.33353130$ and $-0.31356932$. This is not a good sign for our model, as we want to see a strong correlation between the predictor variables and the response variable. This may be because of the distribution of our response, or the simple variability between counties.
Let's create a color-coded correlation matrix plot for a better visualization.
```{r}
corrplot(cor(modelvariables), method = "color", type = "upper", tl.col = "black", tl.srt = 45, colorbar=TRUE)
```

```{r}
png("cormat.png", width = 1200, height = 1200)
cormat <- cor(modelvariables)
# Generate the correlation plot
corrplot(cormat, method = "color", type = "upper",
         tl.col = "black", tl.srt = 45, 
         addCoef.col = "black", # Add correlation coefficients
         col = colorRampPalette(c("#E46726", "white", "#6D9EC1"))(200)) # Custom color palette
dev.off()
```

# ```{r}
# png("cormat_hclust.png", width = 1200, height = 1200)
# cormat <- cor(modelvariables)
# # Generate the correlation plot
# corrplot(cormat, method = "color", type = "upper", order = "hclust",
#          tl.col = "black", tl.srt = 45, 
#          addCoef.col = "black", # Add correlation coefficients
#          col = colorRampPalette(c("#E46726", "white", "#6D9EC1"))(200)) # Custom color palette
# dev.off()
# ```

```{r}
png("colorcorplot.png", width = 1200, height = 1200, res=144)
corrplot.mixed(cor(modelvariables), lower = "number", upper = "color", tl.pos="lt", tl.col = "black", tl.srt = 45)
dev.off()
```

The correlation matrix and the pairwise scatterplots confirm that there is no strong correlation between the predictor variables and the response variable. Again, this is not a good sign for our model, but this may be due to the distribution of our response, or the simple variability between counties.

# Distributions of the Predictor Variables
```{r}
par(mfrow=c(4, 5), mar=c(2, 2, 2, 1) + 0.1, oma=c(0, 0, 4, 0))
# Loop over numeric columns and create histograms
for (i in 1:ncol(modelvariables)) {
  valid_data <- modelvariables[[i]][!is.na(modelvariables[[i]])]
  if (length(valid_data) > 0) {
    hist(valid_data, main=colnames(modelvariables)[i], xlab=colnames(modelvariables)[i],
         col="lightblue", border="darkblue")  # Using light blue fill with dark blue borders
  } else {
    plot.new()
    text(0.5, 0.5, "No data available")
  }
}
mtext("Distributions of Predictor Variables: Histograms", side=3, outer=TRUE, line=1, cex=1.5)
```

```{r}
# saving histograms into png image
png("histograms.png", width = 1200, height = 1200, res=144)
par(mfrow=c(4, 5), mar=c(2, 2, 2, 1) + 0.1, oma=c(0, 0, 4, 0))
# Loop over numeric columns and create histograms
for (i in 1:ncol(modelvariables)) {
  valid_data <- modelvariables[[i]][!is.na(modelvariables[[i]])]
  if (length(valid_data) > 0) {
    hist(valid_data, main=colnames(modelvariables)[i], xlab=colnames(modelvariables)[i],
         col="lightblue", border="darkblue")  # Using light blue fill with dark blue borders
  } else {
    plot.new()
    text(0.5, 0.5, "No data available")
  }
}
mtext("Distributions of Predictor Variables: Histograms", side=3, outer=TRUE, line=1, cex=1.5)
dev.off()
```
# The Null Model
The null model is the mean of the response variable, ACKY, which is $0.1479186$, or $14.79\%$. We will use the RMSE to evaluate our model's performance. We will also look at the distributions of the predictor variables and the correlation between the predictor variables and the response variable.

# Model Evaluation
We will use the RMSE to evaluate our model's performance. We will also look at the distributions of the predictor variables and the correlation between the predictor variables and the response variable.

```{r}
# Predicting the response variable using the model
test$pred <- predict(model, test, type = "response")

# Calculating the RMSE
test_rmse <- sqrt(mean((test$ACKY - test$pred)^2))

# Printing the RMSE
test_rmse
```
Our model's RMSE is $0.07180792$, or $7.18\%$. This is a good sign for our model, as we want to see a low RMSE. This means that our model's predictions are close to the actual values. We will also look at the distributions of the predictor variables and the correlation between the predictor variables and the response variable.

```{r}
# Plotting the predicted vs. actual values
ggplot(test, aes(x = ACKY, y = pred)) +
  geom_point() +
  geom_abline(intercept = 0, slope = 1, color = "red") +
  labs(title = "Predicted vs. Actual Values",
       x = "Actual Values",
       y = "Predicted Values")
```